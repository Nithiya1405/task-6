import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
%matplotlib inline
df=pd.read_csv('disney_plus_titles.csv')
df.head()
df.columns.values
df.isna().sum()
df.info()
# 1. Most frequent genres
genre_count = df['listed_in'].str.split(', ').explode().value_counts()
plt.figure(figsize=(12, 6))
sns.barplot(x=genre_count.head(10).index, y=genre_count.head(10).values, palette="viridis")
plt.title('Top 10 Most Frequent Genres on Disney Plus', fontsize=16)
plt.xlabel('Genre', fontsize=14)
plt.ylabel('Frequency', fontsize=14)
plt.xticks(rotation=45, fontsize=12)
plt.yticks(fontsize=12)
plt.show()
# 2. Distribution of content ratings over time
df['date_added'] = pd.to_datetime(df['date_added'])
rating_trend = df.groupby([df['date_added'].dt.year, 'rating']).size().unstack().fillna(0)
plt.figure(figsize=(12, 6))
sns.lineplot(data=rating_trend)
plt.title('Distribution of Content Ratings Over Time', fontsize=16)
plt.xlabel('Year', fontsize=14)
plt.ylabel('Number of Titles', fontsize=14)
plt.xticks(fontsize=12)
plt.yticks(fontsize=12)
plt.legend(title='Rating', fontsize=12, title_fontsize=14)
plt.show()
# 3. Content production by country and genre
country_genre_count = df['country'].str.split(', ').explode().value_counts()
plt.figure(figsize=(12, 6))
sns.barplot(x=country_genre_count.head(10).index, y=country_genre_count.head(10).values, palette="magma")
plt.title('Top 10 Countries Producing Content on Disney Plus', fontsize=16)
plt.xlabel('Country', fontsize=14)
plt.ylabel('Number of Titles', fontsize=14)
plt.xticks(rotation=45, fontsize=12)
plt.yticks(fontsize=12)
plt.show()
# 4. Number of new titles added per year
titles_per_year = df['date_added'].dt.year.value_counts().sort_index()
plt.figure(figsize=(12, 6))
sns.barplot(x=titles_per_year.index, y=titles_per_year.values, palette="coolwarm")
plt.title('Number of New Titles Added Per Year', fontsize=16)
plt.xlabel('Year', fontsize=14)
plt.ylabel('Number of Titles', fontsize=14)
plt.xticks(rotation=45, fontsize=12)
plt.yticks(fontsize=12)
plt.show()
# 5. Most prolific directors and their associated genres
director_count = df['director'].value_counts().head(10)
plt.figure(figsize=(12, 6))
sns.barplot(x=director_count.index, y=director_count.values, palette="cubehelix")
plt.title('Top 10 Most Prolific Directors on Disney Plus', fontsize=16)
plt.xlabel('Director', fontsize=14)
plt.ylabel('Number of Titles', fontsize=14)
plt.xticks(rotation=45, fontsize=12)
plt.yticks(fontsize=12)
plt.show()
# Directors and Their Associated Genres
director_genre = df.explode('listed_in').groupby('director')['listed_in'].apply(lambda x: ', '.join(x.unique()))
print("Directors and Their Associated Genres:\n", director_genre.head(10))
# 6. Average duration of movies vs. TV shows
df['duration_minutes'] = df['duration'].apply(lambda x: int(x.split()[0]) if 'min' in x else None)
average_duration = df.groupby('type')['duration_minutes'].mean()
plt.figure(figsize=(12, 6))
sns.barplot(x=average_duration.index, y=average_duration.values, palette="pastel")
plt.title('Average Duration of Movies vs. TV Shows on Disney Plus', fontsize=16)
plt.xlabel('Type', fontsize=14)
plt.ylabel('Average Duration (minutes)', fontsize=14)
plt.xticks(fontsize=12)
plt.yticks(fontsize=12)
plt.show()
# 7. Cast size for movies vs. TV shows
df['cast_size'] = df['cast'].apply(lambda x: len(x.split(', ')) if pd.notnull(x) else 0)
cast_size_distribution = df.groupby('type')['cast_size'].mean()
plt.figure(figsize=(12, 6))
sns.barplot(x=cast_size_distribution.index, y=cast_size_distribution.values, palette="muted")
plt.title('Average Cast Size of Movies vs. TV Shows on Disney Plus', fontsize=16)
plt.xlabel('Type', fontsize=14)
plt.ylabel('Average Cast Size', fontsize=14)
plt.xticks(fontsize=12)
plt.yticks(fontsize=12)
plt.show()
# 8. Distribution of content duration
plt.figure(figsize=(12, 6))
sns.histplot(df[df['type'] == 'Movie']['duration_minutes'].dropna(), bins=30, kde=True, color='dodgerblue')
plt.title('Distribution of Movie Durations', fontsize=16)
plt.xlabel('Duration (minutes)', fontsize=14)
plt.ylabel('Frequency', fontsize=14)
plt.xticks(fontsize=12)
plt.yticks(fontsize=12)
plt.show()
# 9. Boxplot of content duration by type
plt.figure(figsize=(12, 6))
sns.boxplot(x='type', y='duration_minutes', data=df)
plt.title('Boxplot of Duration by Content Type', fontsize=16)
plt.xlabel('Content Type', fontsize=14)
plt.ylabel('Duration (minutes)', fontsize=14)
plt.xticks(fontsize=12)
plt.yticks(fontsize=12)
plt.show()
# 10. Correlation heatmap of numerical features
plt.figure(figsize=(14, 10))
corr_matrix = df[['duration_minutes', 'cast_size']].corr()
sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', fmt='.2f', linewidths=0.5)
plt.title('Correlation Matrix', fontsize=16)
plt.xticks(fontsize=12, rotation=45)
plt.yticks(fontsize=12)
plt.show()
